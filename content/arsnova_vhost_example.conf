<VirtualHost *:80>
	ServerAdmin arsnova@example.org

	RewriteEngine On
	# production:
	RewriteRule ^/(.*) https://arsnova.example.org/$1 [R=301,L]
	# testing:
	#RewriteRule ^/(.*) https://%{HTTP_HOST}/$1 [R=301,L]

	ErrorLog ${APACHE_LOG_DIR}/arsnova-error.log

	# Possible values include: debug, info, notice, warn, error, crit,
	# alert, emerg.
	LogLevel warn

	CustomLog ${APACHE_LOG_DIR}/arsnova-access.log combined
</VirtualHost>

<IfModule mod_ssl.c>
<VirtualHost _default_:443>
	ServerName arsnova.example.org
	ServerAdmin arsnova@example.org

	# ARSnova on Tomcat
	# Change these paths in case you deployed the WAR files to different contexts
	JkMount /api* balancer
	JkMount /mobile* balancer
	JkMount /presenter* balancer
	JkMount /mlu* balancer

	RewriteEngine On

	RewriteRule ^/$ /mobile/ [R=301,L]
	RewriteRule ^/arsnova-config$ /api/configuration/ [PT,L]

	ErrorLog ${APACHE_LOG_DIR}/arsnova-error.log

	# Possible values include: debug, info, notice, warn, error, crit,
	# alert, emerg.
	LogLevel warn

	CustomLog ${APACHE_LOG_DIR}/arsnova-access.log combined

	#   SSL Engine Switch:
	#   Enable/Disable SSL for this virtual host.
	SSLEngine on

	#   A self-signed (snakeoil) certificate can be created by installing
	#   the ssl-cert package. See
	#   /usr/share/doc/apache2.2-common/README.Debian.gz for more info.
	#   If both key and certificate are stored in the same file, only the
	#   SSLCertificateFile directive is needed.
	SSLCertificateFile    /etc/apache2/certs/arsnova.crt
	SSLCertificateKeyFile /etc/apache2/certs/arsnova.pem

	#   Server Certificate Chain:
	#   Point SSLCertificateChainFile at a file containing the
	#   concatenation of PEM encoded CA certificates which form the
	#   certificate chain for the server certificate. Alternatively
	#   the referenced file can be the same as SSLCertificateFile
	#   when the CA certificates are directly appended to the server
	#   certificate for convinience.
	SSLCertificateChainFile /etc/apache2/certs/mlu-chain.crt

	#   Certificate Authority (CA):
	#   Set the CA certificate verification path where to find CA
	#   certificates for client authentication or alternatively one
	#   huge file containing all of them (file must be PEM encoded)
	#   Note: Inside SSLCACertificatePath you need hash symlinks
	#         to point to the certificate files. Use the provided
	#         Makefile to update the hash symlinks after changes.
	#SSLCACertificatePath /etc/ssl/certs/
	#SSLCACertificateFile /etc/apache2/ssl.crt/ca-bundle.crt

	# MSIE 7 and newer should be able to use keepalive
	BrowserMatch "MSIE [17-9]" ssl-unclean-shutdown
</VirtualHost>
</IfModule>
